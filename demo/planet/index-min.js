define(function(a){var b=a("com/com"),c=a("com/timer"),d=a("com/loader"),e={universe:"./image/universe.jpg"},f=function(a,b){var c={x:a.x+a.width/2,y:a.y+a.height/2,r:a.width/2},d={x:b.x+b.width/2,y:b.y+b.height/2,r:b.width/2},e=Math.sqrt(Math.pow(c.x-d.x,2)+Math.pow(c.y-d.y,2));return e<c.r+d.r};return{init:function(){var a=document.getElementById("canvas");a.width=document.body.getBoundingClientRect().width,a.height=document.body.getBoundingClientRect().height;var g=new d(e),h=new b(a),i=new c,j=40,k=100+j/2,l=k,m=6,n=2*Math.PI*100/m,o=100,p=o*n*n/k,q=o*n*n/(h.height/2-j/2),r=!1;return g.on("complete",function(){function a(){for(var a=Math.ceil(3*Math.random()),c=0;a>c;c++){var d=new b({x:Math.random()*h.width,y:Math.random()*h.height,width:15,height:15,fillColor:"gold",shape:b.Shape.Circle}).on("render:before",function(){f(this,e)&&(this.x=Math.random()*h.width,this.y=Math.random()*h.width,e.fillColor="blue"==e.fillColor?"green":"blue")});h.append(d)}}var c=new b({width:h.width,height:h.height,backgroundImage:g.get("universe"),shape:b.Shape.Rect,painter:b.Painter.Bitmap}),d=new b({x:h.width/2-j/2,y:h.height/2-j/2,width:j,height:j,fillColor:"gold",shape:b.Shape.Circle}),e=new b({width:20,height:20,circleRotate:0,fillColor:"blue",shape:b.Shape.Circle}),m=new b({x:h.width/2-k,y:h.height/2-k,width:2*k,height:2*k,fillColor:"rgba(0,0,0,0)",strokeColor:"#000",shape:b.Shape.Circle});h.append(c),h.append(d),h.append(e),a(),d.on("touchstart",function(){r=!0}),d.on("touchend",function(){r=!1});var s=0,t={x:h.width/2,y:h.height/2};a(),i.on("run",function(a){var b=4e3/l;r?p+=b:p-=b,q>p&&(p=q,console.log("lose")),l=n*n/p*o;var c=n/l;e.circleRotate>2*Math.PI?e.circleRotate=0:e.circleRotate+=c*a,m.x=t.x-l,m.y=t.y-l,m.width=2*l,m.height=2*l,e.x=t.x+Math.sin(e.circleRotate)*l-e.width/2,e.y=t.y-Math.cos(e.circleRotate)*l-e.height/2,console.log(l),h.clear(),h.render(a),s+=a,s>1&&(s=0,fps.innerHTML="FPS:"+Math.floor(1/a))}).start()}),i}}});